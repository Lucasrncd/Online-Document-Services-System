<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technological University of the Philippines</title>
    <link rel="stylesheet" href="docu_des.css">
    <link rel="icon" type="image/png" href="assets/logo.png?v=2">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>

<body>
    <header class="main-header">
        <div class="logo-container">
            <img src="./assets/logo.png" alt="TUP Logo" class="header-logo">
        </div>
        <nav class="main-nav">
            <a href="Main.php#home-section" class="active">Home</a>
            <a href="Main.php#about-section">About</a>
            <a href="Main.php#guidelines-section">Guidelines</a>
            <a href="Main.php#contacts-section">Contacts</a>
            <a href="payment_info.php">Payment</a>
            <a href="profile.php">Profile</a>
            <a href="status.html">Status</a>
        </nav>
        <a href="login.php" class="logout-btn">Logout</a>
    </header>

    <div class="container">
        <div class="header">Document List</div>
        <div class="content">
            <!--FORM SECTION-->
            <form action="docu_listbackend.php" method="POST" id="documentForm">
                <table class="table">
                    <tr>
                        <th>Request for:</th>
                        <th>Price</th>
                        <th>No. of copies</th>
                        <th>Amount</th>
                    </tr>
                    <tr data-doc-id="1" data-price="220">
                        <td>
                            <input type="checkbox" id="doc_1" name="documents[1][selected]" value="1" class="doc-checkbox">
                            <label for="doc_1">Diploma</label>
                        </td>
                        <td class="price-cell">220 pesos</td>
                        <td>
                            <input type="number" id="copies_1" name="documents[1][copies]" min="0" max="2" value="0" class="copies" data-doc-id="1" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="2" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_2" name="documents[2][selected]" value="1" class="doc-checkbox">
                            <label for="doc_2">Transcript of Records</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_2" name="documents[2][copies]" min="0" max="2" value="0" class="copies" data-doc-id="2" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="3" data-price="60">
                        <td>
                            <input type="checkbox" id="doc_3" name="documents[3][selected]" value="1" class="doc-checkbox">
                            <label for="doc_3">Evaluation/Checklist</label>
                        </td>
                        <td class="price-cell">60 pesos</td>
                        <td>
                            <input type="number" id="copies_3" name="documents[3][copies]" min="0" max="2" value="0" class="copies" data-doc-id="3" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="4" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_4" name="documents[4][selected]" value="1" class="doc-checkbox">
                            <label for="doc_4">Honorable Dismissal</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_4" name="documents[4][copies]" min="0" max="2" value="0" class="copies" data-doc-id="4" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="5" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_5" name="documents[5][selected]" value="1" class="doc-checkbox">
                            <label for="doc_5">Certification of Grades</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_5" name="documents[5][copies]" min="0" max="2" value="0" class="copies" data-doc-id="5" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="6" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_6" name="documents[6][selected]" value="1" class="doc-checkbox">
                            <label for="doc_6">Certification of Graduation</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_6" name="documents[6][copies]" min="0" max="2" value="0" class="copies" data-doc-id="6" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="7" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_7" name="documents[7][selected]" value="1" class="doc-checkbox">
                            <label for="doc_7">Certification of Earned Units</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_7" name="documents[7][copies]" min="0" max="2" value="0" class="copies" data-doc-id="7" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="8" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_8" name="documents[8][selected]" value="1" class="doc-checkbox">
                            <label for="doc_8">Certification of Enrollment</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_8" name="documents[8][copies]" min="0" max="2" value="0" class="copies" data-doc-id="8" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr data-doc-id="9" data-price="100">
                        <td>
                            <input type="checkbox" id="doc_9" name="documents[9][selected]" value="1" class="doc-checkbox">
                            <label for="doc_9">DFA/CHED Authentication of Student's Record</label>
                        </td>
                        <td class="price-cell">100 pesos</td>
                        <td>
                            <input type="number" id="copies_9" name="documents[9][copies]" min="0" max="2" value="0" class="copies" data-doc-id="9" disabled>
                        </td>
                        <td class="amount">0</td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="3" class="total-label">Total:</td>
                        <td class="amount total-amount" id="totalAmount">0</td>
                    </tr>
                </table>
                <!-- Hidden input to store total amount for backend -->
                <input type="hidden" name="total_amount" id="hiddenTotalAmount" value="0">

                <div class="buttons">
                    <a href="request_form.html" class="back-btn">Back</a>
                    <button type="submit" id="submitBtn" class="submit-btn">Submit</button>
                </div>
            </form>

            <div class="note">
                <span>If the document/s you wish to request are not listed above, kindly contact the registrar at</span>
                <span class="email"> registrar@tup.edu.ph</span><span> or </span><span class="email"> uitc@tup.edu.ph</span>
                <span>for further assistance.</span>
            </div>
        </div>
    </div>

    <!--SCRIPT FOR COMPUTATION-->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('documentForm');
            const rows = document.querySelectorAll('.table tr[data-doc-id]');
            const totalAmountDisplay = document.getElementById('totalAmount');
            const hiddenTotalAmount = document.getElementById('hiddenTotalAmount');
            const submitBtn = document.getElementById('submitBtn');

            rows.forEach(row => {
                const docId = row.getAttribute('data-doc-id');
                const checkbox = document.getElementById(`doc_${docId}`);
                const numberInput = document.getElementById(`copies_${docId}`);
                const amountCell = row.querySelector('.amount');
                const price = parseInt(row.getAttribute('data-price'));

                // Initially disable the number input
                numberInput.disabled = true;

                // Enable/disable input based on checkbox
                checkbox.addEventListener('change', () => {
                    numberInput.disabled = !checkbox.checked;
                    if (!checkbox.checked) {
                        numberInput.value = 0;
                    } else {
                        numberInput.value = 1; // Set default to 1 when checked
                    }
                    updateRow();
                });

                numberInput.addEventListener('input', updateRow);

                function updateRow() {
                    if (checkbox.checked && parseInt(numberInput.value) > 0) {
                        const copies = parseInt(numberInput.value) || 0;
                        const amount = price * copies;
                        amountCell.textContent = amount;
                    } else {
                        amountCell.textContent = 0;
                    }
                    calculateTotal();
                }
            });

            function calculateTotal() {
                let total = 0;
                rows.forEach(row => {
                    const rowAmount = parseInt(row.querySelector('.amount').textContent) || 0;
                    total += rowAmount;
                });
                totalAmountDisplay.textContent = total;
                hiddenTotalAmount.value = total;
            }

            // Handle form submission
            submitBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Validate that at least one document is selected
                let hasValidSelection = false;
                
                rows.forEach(row => {
                    const docId = row.getAttribute('data-doc-id');
                    const checkbox = document.getElementById(`doc_${docId}`);
                    const numberInput = document.getElementById(`copies_${docId}`);
                    
                    if (checkbox.checked && parseInt(numberInput.value) > 0) {
                        hasValidSelection = true;
                    }
                });

                if (!hasValidSelection) {
                    alert('Please select at least one document with a valid number of copies (1-2).');
                    return;
                }

                const total = parseInt(hiddenTotalAmount.value);
                if (total <= 0) {
                    alert('Total amount must be greater than zero.');
                    return;
                }

                // Submit the form
                form.submit();
            });
        });
    </script>
    
</body>
</html>